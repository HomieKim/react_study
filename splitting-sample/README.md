# 19장 코드 스플리팅

> 리액트 프로젝트를 사용자에게 제공할 때는 빌드 작업을 거쳐서 배포해야 합니다.
빌드작업을 통해 프로젝트에서 사용되는 자바스트립트 파일 안에서 불필요한 주석, 경고메세지, 공백 등을 제거하여 파일 크기를 최소화하거나 브라우저에서 JSX문법이나 최신 자바스크립트 문법이 원활하게 실행되도록 코드 트랜스파일 작업도 할 수 있습니다.

> 웹팩에서 별도의 설정을 하지 않으면 프로젝트에서 사용 중인 모든 자바스크립트 파일이 하나로 합쳐지고, 모든 CSS파일도 하나의 파일로 합쳐집니다.

> CRA로 프로젝트를 빌드할 경우 최소 두개 이상의 자바스크립트 파일이 생성됩니다.
CRA의 기본 웹팩 설정에는 SplitChunks라는 기능이 적용되어 node_modules나 여러 파일 간에 공유된 파일을 자동으로 따로 분리시켜 캐싱의 효과를 누릴 수 있게 해줍니다.

* 19.1 함수 비동기 로딩
    - 리액트 프로젝트에 별도로 설정하지 않으면 SPA를 구성하는 컴포넌트가 모두 한 파일(main)에 저장됩니다.
    - 만약 애플리케이션의 규모가 커진다면 지금 당장 필요하지 않은 컴포넌트 정보도 모두 불러오면서 파일 크기가 매우 커집니다.
    - 이러한 문제를 해결하는 방법이 코드 비동기 로딩입니다.
    - 코드 비동기 로딩을 통해 자바스크립트 함수, 객체 혹은 컴포넌트를 처음에는 불러오지 않고 필요한 시점에 불러와 사용할 수 있습니다.
    - import를 상단에서 하지 않고 함수형태로 메서드 안에서 하면 파일을 따로 분리 시켜서 저장합니다.
    ```javascript
        const onClick = () => {
            import('./notify').then(result => result.default());
        }
    ```

* 19.2 React.lazy, Suspense
    - React.lazy와 Suspense를 사용하면 코드 스플리팅을 하기 위해 state를 따로 선언하지 않고도 코드 스플리팅을 할 수 있습니다.
    - React.lazy는 컴포넌트를 렌더링하는 시점에서 비동기적으로 로딩할 수 있게 해줍니다.
    ```javascript
        const SplitMe = React.lazy(() => import('./SplitMe'));
    ```
    - Suspense는 리액트 내장 컴포넌트로서 코드 스플리팅된 컴포는트를 로딩하도록 할수 있고 로딩이 끝나지 않았을 때 보여줄 ui를 설정할 수 있습니다.
    ```javascript
        import {Suspnese} from 'react';

        <Suspense fallback={<div> loading...</div>}>
            <SplitMe />
        </Suspense>    
    ```

* 19.2.3 Loadable Componets
    - Loadable Componets는 코드 스플리팅을 편하게 하도록 도와주는 서드파티 라이브러리 입니다.
    - 이 라이브러리의 장점은 서버사이드 렌더링을 지원한다는 것입니다.
    - 서버사이드 렌더링이란 웹 서비스의 초기 로딩속도 개선, 캐싱 및 검색 엔진 최적화를 가능하게 해주는 기술 입니다.
    - 서버사아디 렌더링을 사용하면 웹서비스의 초기 렌더링을 사용자의 브라우저가 아닌 서버 쪽에서 처리합니다.